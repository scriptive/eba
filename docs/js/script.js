/*!
    eba -- Effortless bible analysis
    Version 0.0.3-2017.05.07
    https://scriptive.github.io/eba
    (c) 2017
*/
!function(e){e.merge({config:{name:"Effortless bible analysis alpha",description:"This is not the entire bible. This is the bible analysis according to topics. Thus it helps to search, check and study the scriptures. Please be advised, read the bible book to meditate.",author:"tuang",version:"0.0.3",build:"1.0.0",id:"eba",idUnique:"eba:unique",developer:"Khen Solomon Lethil",file:{template:"z.html",lang:"https://storage.googleapis.com/effortless/language.json",urlLocal:"eba/bId.xml",urlAPI:["https://storage.googleapis.com/effortless/bId.xml"]},fileStorage:{RequestQuota:1073741824,Permission:1,objectStore:{name:"eba",version:1}},lang:{isLocalRemove:'Would you like to remove "{is}" from local?',tryAWord:"Try a word or two!",noMatchFor:"No match for {for}!",noCategoryContent:"This category has no content...",noCategoryData:"This category has no data...",noBookmark:"No Star...",isNotFound:'Not found: "{is}"',Loading:"Loading",isError:"Error",addLanguage:"Add",removeLanguage:"Remove",manageLanguage:"Add Languages"},classname:{active:"active",inactive:"inactive",filter:"filter"},page:{home:{id:1,name:"Languages",class:"home",title:"Effortless"},category:{id:2,class:"book"},reader:{id:3,class:"chapter"},lookup:{id:4,name:"Search",class:"lookup",title:"Search"},lookupresult:{id:5,title:"Effortless"},bookmark:{id:6,name:"Stars",class:"bookmark",title:"Stars"},randomverse:{id:7,name:"Random Verse",class:"randomverse",title:"Random Verse"},setting:{id:8,name:"Display",class:"setting",title:"Display"},about:{id:9,name:"About",class:"info",title:"About"},contact:{id:10,name:"Contact",class:"info",title:"Contact"}}},initiate:function(){var n=e.config,t=e.localStorage;n.pageHome=Object.keys(n.page)[0];var a=function(){var a=t.select("language").name.language;return new Promise(function(t,r){e.fileStorage=fileStorage(n.fileStorage,{success:function(){e.book.all=a,t()},fail:function(e){r(e)}})}).then(function(){return!0},function(e){return e})},r=function(){var e=t.name.query,a={page:n.pageHome,language:1,testament:1,category:1,q:"",pagePrevious:n.pageHome,result:""},r={page:function(e,t,a,r){r[e]=n.page.hasOwnProperty(t.toLowerCase())?t.toLowerCase():a},pagePrevious:function(e,t,a,r){r[e]&&n.page.hasOwnProperty(r[e])?a!=r.page&&(r[e]=n.page[a].id<=n.page[r.page].id?a:n.pageHome):r[e]=a,n[e]=r[e]},q:function(e,n,t,a){a[e]=decodeURIComponent(n)}};return new Promise(function(t,o){try{e.isEmpty()?e.merge(a,n.hash):(a.pagePrevious=e.page,e.merge(n.hash)),e.each(function(e,n,t){r.isFunction(e)&&r[e](e,n,a[e],t)}),t()}catch(e){o(e)}}).then(function(){return t.update("query"),!0},function(e){return e})},o=function(){return e.fileStorage.download({url:n.file.template.replace(/z/,["default","desktop"].join(".")),before:function(e){e.overrideMimeType("text/html; charset=utf-8"),e.responseType="document"}}).then(function(e){try{for(var n=e.data.body;n.firstChild;)document.body.appendChild(n.firstChild);return i().then(function(e){return!0===e&&document.querySelector("div#screen").remove(),e})}catch(e){return e}},function(e){return e})},i=function(){return r().then(function(n){return!0===n?new Promise(function(n,a){e.page[t.name.query.page](n,a)}).then(function(){return document.body.addAttr("id",t.name.query.page),e.Toggle.header().then(function(n){try{e.dataContent()}catch(n){return n}return!0})},function(e){return e}):n})};new Promise(function(r,i){t.select("setting").select("query").select("language").select("randomverse").select("todo"),t.select("bookmark").select("suggestion"),t.name.setting.hasOwnProperty("build")?t.name.setting.build==n.build?n.requireUpdate=0:n.requireUpdate=2:n.requireUpdate=1,n.requireUpdate&&(t.name.setting.version=n.version,t.name.setting.build=n.build,t.update("setting")),a().then(function(n){return document.body.classList.add(e.config.Screen),t.name.setting.hasOwnProperty("class")?t.name.setting.class.each(function(e,n){document.body.classList.add(n)}):t.name.setting.class={},!0===n?o():n}).then(function(e){!0===e?r():i(e)})}).then(function(){e.hashChange(function(){i().then(function(e){!0!==e&&console.log("page error",e)})})},function(n){"object"==typeof n&&n.hasOwnProperty("message")?e.notification(n.message):"string"==typeof n&&e.notification(n)})},dialog:{container:function(){return e.elementSelect("div#dialog")}},nav:{container:function(){return e.elementSelect("nav")},toHome:function(n){window.location.hash=e.config.pageHome},toPrevious:function(n){window.location.hash=n.dataset.hasOwnProperty("page")?n.dataset.page:e.config.pagePrevious},setNamePrevious:function(n){n.innerHTML=e.localStorage.name.query.page,n.eventClick(function(){window.location.hash=n.dataset.hasOwnProperty("page")?n.dataset.page:e.config.pagePrevious})},setTitle:function(n){n.innerHTML=e.config.name},setName:function(n){e.config.page[e.localStorage.name.query.page].hasOwnProperty("title")?n.innerHTML=e.config.page[e.localStorage.name.query.page].title:n.innerHTML=e.config.name},toPage:function(n){e.Toggle.nav(n).style.display="none"},setReader:function(n){e.Toggle.menu(n,function(n){var t=n.appendChild(e.elementCreate("ol"));e.config.catalog.each(function(n,a){a.each(function(n,a){t.appendChild(e.elementCreate("li").addAttr("data-cls",a.class).addAttr("data-title",a.total).eventClick(function(n){n.target.toggleClass("active"),e.Toggle.main().querySelectorAll("ol li ol li").each(function(e,n){n.hasClass(a.class)&&n.toggleDisplay()})}).addContent(a.name).addClass("active"))})})},function(){})}},header:{container:function(){return e.elementSelect("header")},lookup:function(e){}},main:{container:function(){return e.elementSelect("main")}},footer:{container:function(){return e.elementSelect("footer")}},page:{home:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol"),i=e.Toggle.main(!0);i.appendChild(o).setAttribute("class","main-home common-box-main");var l=function(){o.emptyElement(),r.name.language.each(function(n,t){o.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).eventClick(function(){window.location.hash={language:n}.paramater(["#category"])}).innerHTML=t.name})},c=function(e){return!(!r.name.hasOwnProperty("language")||!r.name.language.isObject()||r.name.language.isEmpty())&&(!e||r.name.language.hasOwnProperty(e))},s=i.appendChild(e.elementCreate("ol").addAttr("class","main-footer")),d=s.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("ul")),u=d.appendChild(e.elementCreate("li"));if(u.innerHTML=a.lang.manageLanguage,c()&&l(),e.hasOwnProperty("nav")&&e.nav.hasOwnProperty("container")){var m=e.nav.container(),p=m.firstElementChild,g=p.firstElementChild,f=g.nextElementSibling,h=function(){e.fileStorage.download({url:a.file.lang}).then(function(n){m.style.display="block",f.emptyElement(),e.book.language=JSON.parse(n.data);var t=f.appendChild(e.elementCreate("ul"));e.book.language.each(function(n,r){var o=e.elementCreate("li"),i=e.elementCreate("div"),s=e.elementCreate("div");i.innerHTML=r.name,s.eventClick(function(t){c(n)?new e.xml(n).delete().then(function(){s.innerHTML=a.lang.addLanguage},function(){}).then(function(){l()}):new e.xml(n).download(function(){s.emptyElement().appendChild(e.elementCreate("span").addAttr("class","icon-loading animate-spin"))}).then(function(t){return new e.xml(n).save(t).then(function(){s.innerHTML=a.lang.removeLanguage},function(e){s.innerHTML=a.lang.addLanguage})},function(){s.innerHTML=a.lang.isError}).then(function(){l()})}).innerHTML=a.lang.addLanguage,c(n)&&(o.setAttribute("class",a.classname.active),s.innerHTML=a.lang.removeLanguage),o.appendChild(i),o.appendChild(s),t.appendChild(o)})},function(e){console.log(e)})},C=function(e){!p.contains(e.target)&&c()&&v(),e.stopPropagation()},v=function(){f.emptyElement(),document.body.classList.contains("nav")||document.body.removeClick(C),m.styleDisplay("none")},y=function(e){m.toggleDisplay(function(){h(),document.body.classList.contains("nav")||document.body.eventClick(C)},function(){v()}),e&&e.stopPropagation()};c()||y(),u.eventClick(y,!1)}n()},category:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol"),i=e.Toggle.main(!0),l=r.name.query,c=l.page,s=l.language;e.config.page[c].title=e.book.all[s].name,i.appendChild(o).setAttribute("class","main-category"),new e.Content(s).xml().then(function(e){e.section(o).then(function(e){},function(e){console.log(e)})},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",r.name.query.language)}).then(function(){n();var t=e.elementCreate("ol");i.appendChild(t).eventClick(function(n){var t=n.target,a=t.getAttribute("class"),r=document.getElementById(a);e.main.container().firstElementChild.scrollTop=r.offsetTop}).setAttribute("class","main-index"),o.querySelectorAll("li.alpha").each(function(n,a){var r=a.innerHTML,o=a.getAttribute("id");t.appendChild(e.elementCreate("li").addAttr("class",o)).innerHTML=r})})},reader:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol"),i=e.Toggle.main(!0),l=r.name.query,c=l.page,s=l.language;e.config.page[c].title=e.book.all[s].name,i.appendChild(o).setAttribute("class","main-reader"),new e.Content(s).xml().then(function(n){n.reader(o,l.category).then(function(e){},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n})},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",s)}).then(function(){n()});var d=i.appendChild(e.elementCreate("ol").addAttr("class","main-footer")),u=d.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("ul"));u.appendChild(e.elementCreate("li")).addClass(a.classname.active).eventClick(function(e){var n=e.target;o.querySelectorAll("ol li ol li.OT").each(function(e,n){n.toggleDisplay()}),n.hasClass(a.classname.active)?n.removeClass(a.classname.active).addClass(a.classname.inactive):n.removeClass(a.classname.inactive).addClass(a.classname.active)}).innerHTML="OT",u.appendChild(e.elementCreate("li")).addClass(a.classname.active).eventClick(function(e){var n=e.target;o.querySelectorAll("ol li ol li.NT").each(function(e,n){n.toggleDisplay()}),n.hasClass(a.classname.active)?n.removeClass(a.classname.active).addClass(a.classname.inactive):n.removeClass(a.classname.inactive).addClass(a.classname.active)}).innerHTML="NT"},randomverse:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol");e.Toggle.main(!0).appendChild(o).setAttribute("class","main-reader");var i=!1,l=(new Date).toLocaleDateString().toString().replace(/\//g,"");new Promise(function(n,t){r.name.randomverse&&r.name.randomverse.isObject()&&!r.name.randomverse.isEmpty()?r.name.randomverse.id!=l&&(r.name.randomverse.id=l,i=!0):(i=!0,r.name.randomverse.id=l),i?new e.Content(r.name.query.language).xml().then(function(e){e.randomverse().then(function(e){r.name.randomverse.verse=e.information,r.update("randomverse"),n()})}):n()}).then(function(){new e.Content(r.name.query.language).xml().then(function(n){n.bookmark(o,r.name.randomverse.verse).then(function(e){console.log(e)},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n})},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",r.name.query.language)}).then(function(){n()})})},lookup:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol");e.Toggle.main(!0).appendChild(o).setAttribute("class","main-lookup common-box-main"),o.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).appendChild(e.elementCreate("input")).addAttr("type","search").addAttr("name","q").addAttr("id","q").addAttr("placeholder","search..."),o.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).eventClick(function(n){var t=n.target;if(t.nextElementSibling)t.nextElementSibling.removeElement();else{var o=t.parentNode.appendChild(e.elementCreate("ol")).eventClick(function(e){var n=e.target,t=n.getAttribute("id");t&&r.name.query.language!=t&&(n.parentNode.querySelector("."+a.classname.active).removeClass(a.classname.active),n.addClass(a.classname.active),r.name.query.language=t)});r.name.language.each(function(n,t){o.appendChild(e.elementCreate("li").addAttr("id",n).addClass(r.name.query.language==n?a.classname.active:a.classname.inactive)).innerHTML=t.name})}}).innerHTML="Language";var i=o.appendChild(e.elementCreate("li").addAttr("class","lsi")).appendChild(e.elementCreate("div")).eventClick(function(e){var n=e.target,t=n.getAttribute("id");if(t&&r.name.query.testament!=t){var o=n.parentNode.querySelector("."+a.classname.active);o&&o.removeClass(a.classname.active),n.addClass(a.classname.active),r.name.query.testament=t}});i.appendChild(e.elementCreate("p").addAttr("id","1").addClass(1==r.name.query.testament?a.classname.active:a.classname.inactive)).innerHTML="OT",i.appendChild(e.elementCreate("p").addAttr("id","2").addClass(2==r.name.query.testament?a.classname.active:a.classname.inactive)).innerHTML="NT",o.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).eventClick(function(){var e=document.getElementById("q").value;e&&r.name.query.language&&r.name.query.testament&&(window.location.hash={q:e,i:(new Date).getTime()}.paramater(["#lookupresult"]))}).innerHTML="Enter",n()},lookupresult:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol"),i=(e.Toggle.main(!0),r.name.query),l=i.page,c=i.language;e.config.page[l].title=r.name.query.q,e.Toggle.main(!0).appendChild(o).setAttribute("class","main-reader"),new e.Content(c).xml().then(function(n){r.name.query.q?n.lookup(o,r.name.query.q).then(function(e){},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n.replace("{for}",r.name.query.q)}):o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.tryAWord},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",r.name.query.book)}).then(function(){n()})},bookmark:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol");e.Toggle.main(!0).appendChild(o).setAttribute("class","main-reader"),new e.Content(r.name.query.language).xml().then(function(n){n.bookmark(o,r.name.bookmark).then(function(e){console.log(e)},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n})},function(n){o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",r.name.query.language)}).then(function(){n()})},setting:function(n,t){var a=e.config,r=e.localStorage,o=r.name.setting,i=e.elementCreate("ol"),l={fontsize:{title:"font size",style:"body {font-size:$100%;}",option:{"80%":{title:"1",class:"size-small-extra"},"90%":{title:"2",class:"size-small"},"100%":{title:"3",class:"size-normal",defaults:!0},"120%":{title:"4",class:"size-large"},"150%":{title:"5",class:"size-large-extra"}}},background:{title:"background color",style:"body {background-color:$white;}",option:{"#ffffff":{class:"color-white"},"#F8F8F8":{class:"color-lightgray",defaults:!0},"#7f7f7f":{class:"color-dimgrey"},"#b97a59":{class:"color-chocolate"},"#880016":{class:"color-darkred"},"#ed1b24":{class:"color-red"},"#fef102":{class:"color-gold"},"#24b04d":{class:"color-green"},"#3f47cc":{class:"color-darkblue"}}}};e.Toggle.main(!0).appendChild(i).setAttribute("class","main-display"),o.hasOwnProperty("class")||(o.class={}),l.each(function(n,t){var l=i.appendChild(e.elementCreate("li"));l.appendChild(e.elementCreate("h3")).innerHTML=t.title;var c=l.appendChild(e.elementCreate("ol")).addClass(n);t.option.each(function(t,i){var l=c.appendChild(e.elementCreate("li")).addClass(i.class).addClass("icon-ok");if(i.hasOwnProperty("title")&&l.addAttr("data-title",i.title),o.class.hasOwnProperty(n))var s=o.class[n]==i.class?a.classname.active:a.classname.inactive;else if(i.hasOwnProperty("defaults"))var s=a.classname.active;else var s=a.classname.inactive;l.addClass(s).eventClick(function(e){var t=e.target;t.hasClass(a.classname.active)||(t.parentNode.getElementsByClassName(a.classname.active).each(function(e,n){n.removeClass(a.classname.active)}),t.addClass(a.classname.active),o.class.hasOwnProperty(n)&&document.body.hasClass(o.class[n])&&document.body.removeClass(o.class[n]),document.body.hasClass(i.class)||document.body.addClass(i.class),o.class[n]=i.class,r.update("setting"))})})}),n()},about:function(n,t){var a=e.config,r=e.localStorage,o=e.elementCreate("ol");e.Toggle.main(!0).appendChild(o).setAttribute("class","main-information"),o.appendChild(e.elementCreate("li")).innerHTML=a.description,r.name.language.each(function(n,t){var a=o.appendChild(e.elementCreate("li")).addClass(n);a.appendChild(e.elementCreate("h3")).innerHTML=t.name,t.hasOwnProperty("information")&&!t.information.isEmpty()&&(a.appendChild(e.elementCreate("p")).addAttr("data-title","Version").innerHTML=t.information.version,a.appendChild(e.elementCreate("p")).addAttr("data-title","Launched").innerHTML=t.information.launched)}),n()},contact:function(n,t){var a=(e.config,e.localStorage,e.elementCreate("ol"));e.Toggle.main(!0).appendChild(a).setAttribute("class","main-information");var r={email:"supereffortless@gmail.com",introduction:"Please give proper title/subject for your email.",list:["Advice","Broken Report","Copyrights","Discussion","Donation","Mistaken Verse","Question"],conclusion:"You will be replied as soon as possible."};a.appendChild(e.elementCreate("li")).innerHTML=r.email,a.appendChild(e.elementCreate("li")).innerHTML=r.introduction;var o=a.appendChild(e.elementCreate("li"));r.list.each(function(n,t){o.appendChild(e.elementCreate("p")).addAttr("data-title",t).innerHTML="xxxxxxx"}),a.appendChild(e.elementCreate("li")).innerHTML=r.conclusion,n()}},export:{category:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.language).xml().then(function(e){e.exportCategory(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.language)})},testament:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.book).xml().then(function(e){e.exportTestament(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.book)})},book:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.book).xml().then(function(e){e.exportBook(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.book)})},verse:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.book).xml().then(function(e){e.exportVerse(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.book)})}},xml:function(n){var t=e.config,a=e.book,r="language",o=e.localStorage.name,i=this;this.open=function(){return e.fileStorage.open({urlLocal:t.file.urlLocal.replace(/bId/,n),readAs:"readAsText"})},this.download=function(r){var o={dir:JSON.parse(JSON.stringify(t.file.urlAPI)),request:function(a){return e.fileStorage.download({url:a,urlLocal:t.file.urlLocal.replace(/bId/,n),before:function(e){e.overrideMimeType("text/xml; charset=utf-8")},progress:r})},process:function(e,t){var r=o.dir.shift().replace(/bId/,n);return o.request(r).then(function(t){t.xml||(t.xml=(new DOMParser).parseFromString(t.data,t.fileType)),a.file[n]=t.xml,e(t)},function(n){o.dir.length?o.process(e,t):t(n)})}};return new Promise(o.process)},this.save=function(t){return new Promise(function(i,l){e.fileStorage.save(t).then(function(t){o[r][n]=a[r][n],new e.Content(n).xml().then(function(e){e.information().then(function(e){o[r][n].information=e.information},function(e){})},function(e){}).then(function(){e.localStorage.update(r),i(t)})},function(e){l(e)})})},this.delete=function(){return new Promise(function(a,i){e.fileStorage.delete({urlLocal:t.file.urlLocal.replace(/bId/,n),fileNotFound:!0}).then(function(t){delete o[r][n],e.localStorage.update(r),a(t)},function(e){i(e)})})},this.request=function(e){return new Promise(function(t,l){a.file.hasOwnProperty(n)?t(a.file[n]):o[r].hasOwnProperty(n)?i.open().then(function(e){e.xml=(new DOMParser).parseFromString(e.fileContent,e.fileType),a.file[n]=e.xml,t(e.xml)},function(e){i.delete().then(function(){l(e)})}):i.download(e).then(function(e){i.save(e).then(function(){console.log("save success")},function(){console.log("save fail")}).then(function(){t(e.xml)})},function(e){l(e)})})}},Content:function(n){var t,a=e.config,r=e.localStorage,o={category:0,section:0,verse:0};a.catalog={};var i=function(n,t,r){return new Promise(function(i,l){var c=s(r);if(!c.length)return l(a.lang.noCategoryData);c.each(function(i,l){var c,s=r||l.getAttribute("id");l.querySelectorAll(p()).each(function(r,i){var l=t(i);if(l){c||(c=g.createOl(n,s)),o.verse++;var d=i.getAttribute("book"),p=d<=39?1:2,f=i.getAttribute("chapter"),h=i.getAttribute("verse"),C=(i.getAttribute("tag"),m(p)),v=(C.innerHTML,u(d).innerHTML),y=e.book.hasBookmark(s,d,f,h)?a.classname.active:a.classname.inactive,b=d<=39?"OT":"NT",k=v.replace(/\s+/g,"-").toLowerCase(),w=c.appendChild(e.elementCreate("li")).addClass(y).addClass(b).addClass(k);containerBookmark=w.appendChild(e.elementCreate("div")).addClass("icon-star").eventClick(function(n){e.book.addBookmark(n.target.parentNode,s,d,f,h)}),containerVerse=w.appendChild(e.elementCreate("div")),containerVerse.addAttr("data-title","123 234:345".replace(123,v).replace(234,f).replace(345,h)),containerVerse.innerHTML=g.replaceNumber(l)}})}),o.verse?i(o):l(r?a.lang.noCategoryContent:a.lang.noMatchFor)})},l=function(e){return e?t.querySelector('info row[id="0"]'.replace(0,e)):t.querySelectorAll("info row")},c=function(e){return e?t.querySelector('section row[id="0"]'.replace(0,e)):t.querySelectorAll("section row")},s=function(e){return t.querySelectorAll(e?'category[id="0"]'.replace(0,e):"category")},d=function(e){return t.querySelectorAll('category[id="0"] row'.replace(0,e))},u=function(e){return e?t.querySelector('book row[id="0"]'.replace(0,e)):t.querySelectorAll("book row")},m=function(e){return e?t.querySelector('testament row[id="0"]'.replace(0,e)):t.querySelectorAll("testament row")},p=function(e,n,t,a){var r="row";return e&&(r+='[book="0"]'.replace(0,e)),n&&(r+='[chapter="0"]'.replace(0,n)),t&&(r+='[verse="0"]'.replace(0,t)),a&&(r+='[tag="0"]'.replace(0,a)),r},g={replaceKeyword:function(e,n){return"string"==typeof n?e.replace(new RegExp(n,"gi"),"<b>$&</b>"):e},replaceNumber:function(e){return e.match(/\[(.*?)\]/g).length>1?e.replace(/\[(.*?)\]/g,"<sup>$1</sup>"):e.replace(/\[(.*?)\]/g,"")},createOl:function(n,t){o.category++;var a=c(t),r=n.appendChild(e.elementCreate("li"));r.appendChild(e.elementCreate("h2")).addAttr("data-description",a.innerHTML).innerHTML=a.getAttribute("name");return r.appendChild(e.elementCreate("ol"))}},f={section:function(n){return new Promise(function(t,a){var r=[];c().each(function(t,a){o.section++;var i=a.getAttribute("id"),l=a.getAttribute("name"),c=(a.getAttribute("sort"),a.innerHTML,l.charAt(0));r.has(c)||(r.push(c),n.appendChild(e.elementCreate("li").addClass("alpha").addAttr("id",c)).innerHTML=c),n.appendChild(e.elementCreate("li")).addClass("icon-arrow-right").addAttr("data-title",i).appendChild(e.elementCreate("a")).addAttr("data-total",d(i).length).addAttr("data-description",a.innerHTML).addAttr("href",{category:i}.paramater(["#reader"])).innerHTML=l}),t(o)})},randomverse:function(){return new Promise(function(e,n){o.information={};var t=Math.floor(Math.random()*c().length),a=d(t),r=Math.floor(Math.random()*a.length),i=a[r],l=i.getAttribute("book"),s=i.getAttribute("chapter"),u=i.getAttribute("verse");o.information[t]={},o.information[t][l]={},o.information[t][l][s]=[u],e(o)})},information:function(){return new Promise(function(e,n){o.information={},l().each(function(e,n){o.section++;var t=n.getAttribute("id");o.information[t]=n.innerHTML}),e(o)})},reader:function(e,n){return i(e,function(e){return e.innerHTML},n)},lookup:function(e,n){return i(e,function(e){if(new RegExp(n,"i").test(e.innerHTML))return g.replaceKeyword(e.innerHTML,n)})},bookmark:function(n,t){return new Promise(function(i,l){t.each(function(t,i){var l;i.each(function(i,c){c.each(function(c,d){d.each(function(d,f){s(t).each(function(s,d){d.querySelectorAll(p(i,c,f)).each(function(s,d){l||(l=g.createOl(n,t)),o.verse++;var p=i<=39?1:2,h=m(p).innerHTML,C=u(i).innerHTML,v=h.replace(" ","-").toLowerCase(),y=C.replace(" ","-").toLowerCase(),b=e.book.hasBookmark(t,i,c,f)?a.classname.active:a.classname.inactive,k=l.appendChild(e.elementCreate("li")).addClass(b).addClass(v).addClass(y),w=(k.appendChild(e.elementCreate("div")).addClass("icon-star").eventClick(function(n){var o=n.target.parentNode;e.book.addBookmark(o,t,i,c,f),"randomverse"!=r.name.query.page&&(o=o.removeElement(),""===o.innerHTML&&(o=o.parentNode.removeElement(),""===o.innerHTML&&(o.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.noBookmark)))}),k.appendChild(e.elementCreate("div")));w.addAttr("data-title","123 234:345".replace(123,C).replace(234,c).replace(345,f)),w.innerHTML=g.replaceNumber(d.innerHTML)})})})})})}),o.verse?i(o):l(a.lang.noBookmark)})}};this.xml=function(){return new Promise(function(a,r){new e.xml(n).request(function(){}).then(function(e){t=e,a(f)},function(e){r(e)})})}},book:{file:{},addBookmark:function(n,t,a,r,o){var i=e.localStorage,l=i.name.bookmark;n.hasClass(e.config.classname.active)?(l[t][a][r].splice(l[t][a][r].indexOf(o),1),l[t][a][r].length<=0&&(delete l[t][a][r],l[t][a].isEmpty()&&(delete l[t][a],l[t].isEmpty()&&delete l[t])),n.removeClass(e.config.classname.active)):(l.hasOwnProperty(t)||(l[t]={}),l[t].hasOwnProperty(a)||(l[t][a]={}),l[t][a].hasOwnProperty(r)||(l[t][a][r]=[]),l[t][a][r].push(o.toString()),n.addClass(e.config.classname.active)),i.update("bookmark")},hasBookmark:function(n,t,a,r){var o=e.localStorage.name.bookmark;if(o.hasOwnProperty(n)&&o[n].hasOwnProperty(t)&&o[n][t].hasOwnProperty(a))return o[n][t][a].has(r)}}})}(scriptive("app"));