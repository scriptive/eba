/*!
    scriptive -- Javascript application service
    Version 1.0.0
    https://scriptive.github.io/script
    (c) 2016
    root->initial{meta,device}->listen->initiate
*/
!function(win,doc){"use strict";var os="scriptive",Config={},app={todo:{1:"a"},init:function(a){var id=typeof a;if(app.fn.hasOwnProperty(id))return app.fn[id](a)},ready:function(callback){doc.addEventListener("DOMContentLoaded",callback,!1)},fn:{object:function(a){return app.assign()},string:function(a){return win[a]=app.assign()}},assign:function(){return this.root.merge(win[os])},device:{platform:{is:function(needle){return navigator.userAgent.toLowerCase().indexOf(needle)!==-1},ios:function(){return this.iphone()||this.ipod()||this.ipad()},iphone:function(){return!this.windows()&&this.is("iphone")},ipod:function(){return this.is("ipod")},ipad:function(){return this.is("ipad")},android:function(){return!this.windows()&&this.is("android")},ADP:function(){return this.android()&&this.is("mobile")},ADT:function(){return this.android()&&!this.is("mobile")},blackberry:function(){return this.is("blackberry")||this.is("bb10")||this.is("rim")},BBP:function(){return this.blackberry()&&!this.is("tablet")},BBT:function(){return this.blackberry()&&this.is("tablet")},windows:function(){return this.is("windows")},WDP:function(){return this.windows()&&this.is("phone")},WDT:function(){return this.windows()&&this.is("touch")&&!this.WDP()},fxos:function(){return(this.is("(mobile;")||this.is("(tablet;"))&&this.is("; rv:")},FFP:function(){return this.fxos()&&this.is("mobile")},FFT:function(){return this.fxos()&&this.is("tablet")},meego:function(){return this.is("meego")},cordova:function(){return win.cordova&&"file:"===location.protocol},chrome:function(){return"chrome"===Config.Platform},nodeWebkit:function(){return"object"==typeof window.process},mobile:function(){return this.ADP()||this.iphone()||this.ipod()||this.WDP()||this.BBP()||this.FFP()||this.meego()},tablet:function(){return this.ipad()||this.ADT()||this.BBT()||this.WDT()||this.FFT()}},agent:function(){win.addEventListener?win.addEventListener(Config.Orientation.evt,this.orientate,!1):win.attachEvent?win.attachEvent(Config.Orientation.evt,this.orientate):win[Config.Orientation.evt]=this.orientate,this.orientate();var d=[],name={desktop:"desktop",tablet:"tablet",mobile:"mobile",ios:"ios",android:"android",defaults:"default",web:"web",app:"app"};Config.isCordova=this.platform.cordova(),Config.isChrome=this.platform.chrome(),Config.Platform||(Config.Platform=name.web),Config.Screen||(Config.Screen=name.desktop),this.platform.mobile()?Config.Screen=name.mobile:this.platform.tablet()&&(Config.Screen=name.tablet),d.push(Config.Screen,Config.Platform),this.platform.ios()?Config.Device=name.ios:this.platform.android()?Config.Device=name.android:this.platform.hasMethodProperty(Config.Device)||(Config.Device=name.defaults),d.push(Config.Device),Config.DeviceTemplate=[Config.Device,Config.Platform,Config.Screen];var file=[],df=[];for(var i in d){df.push(d[i]);var fl=df.join(".");file.push({type:"link",name:fl},{type:"script",name:fl})}return file},orientate:function(){doc.querySelector("html").setAttribute("class",win.innerHeight<win.innerWidth?Config.Orientation.landscape:Config.Orientation.portrait)}},meta:{locale:{script:{attr:{src:null},extension:".js",dir:"js/"},link:{attr:{rel:"stylesheet",href:null},extension:".css",dir:"css/"}},oblige:function(q){var file=[];for(var type in q)for(var src in q[type])file.push({type:type,name:q[type][src].replace(" ",".")});return file},append:function(){Config.Meta=this.oblige(Config.Meta).concat(app.device.agent()),this.attach()},attach:function(){var o=this,x=Config.Meta.shift(),y=x.type,url=(x.dir||o.locale[y].dir)+x.name+o.locale[y].extension,req=doc.createElement(y);o.locale[y].attr.each(function(i,v){req[i]=v||url}),req.onload=function(){app.root.notification(x.name),Config.Meta.length?o.attach():o.listen()},doc.head.appendChild(req)},listen:function(){app.root.notification("class","icon-database"),Config.isCordova?(app.root.notification("getting Device ready"),doc.addEventListener("deviceready",this.initiate,!1)):this.initiate()},initiate:function(){Config.Execute.each(function(i,v){i="object"==typeof v?Object.keys(v)[0]:v,app.root.execute.call(app.root,i.split(" "),v[i])})}},root:{todo:{},config:{Meta:[],Execute:["Action"],T:[],Handler:"ontouchstart"in document.documentElement?"touchstart":"click",On:"fO",Hash:"hashchange",Device:"desktop",Platform:"web",Layout:null,Browser:"chrome",fileSystask:"Chrome",Orientation:{change:"D1699",landscape:"landscape",portrait:"portrait"},note:{},lang:{},query:{},lookup:{setting:{},book:{}},previous:{},todo:{Orientation:!0,Template:!0},container:{},msg:{info:"#msg"}},info:{version:"2.1.23.2016.1.5"},document:function(response){response.merge({config:{}}),Config=this.config.merge(response.config),app.ready(function(event){Config.Orientation.evt=Object.prototype.hasOwnProperty.call(window,"onorientationchange")?"orientationchange":"resize",response.hasOwnProperty("ready")&&response.ready.call(app.root,event),"string"==typeof Config.msg.info&&(Config.msg.info=doc.querySelector(Config.msg.info)),app.meta.append()})},notification:function(){if(null!==this.config.msg.info)return arguments.length>1?this.config.msg.info.setAttribute(arguments[0],arguments[1]):this.config.msg.info.innerHTML=arguments[0],this.config.msg.info},execute:function(x,y){var i=x.shift();if(this.hasOwnProperty(i)){if(this.isFunction(i))return this[i](y);if(x.length)return app.root.execute.call(this[i],x,y)}return!1},handler:function(){for(var element=doc.getElementsByClassName(Config.On),i=0;i<element.length;i++)element[i].addEventListener(Config.Handler,function(event){var query=this.getAttribute("class").split(" ").filter(function(e){return e}).remove(Config.On);app.root.execute.call(app.root,query,event)})},metalink:function(){arguments[0].each(function(i,v){win[v]=doc.querySelector("link[rel=0]".replace(0,v)).getAttribute("href")})},metacontent:function(){arguments[0].each(function(i,v){win[v]=doc.querySelector("meta[name=0]".replace(0,v)).getAttribute("content")})}}};win[os]=function(a){return new app.init(a)}}(window,document),Object.defineProperties(Object.prototype,{merge:{enumerable:!1,value:function(src){for(var i in src)try{src[i].constructor==Object?this[i].merge(src[i]):this[i]=src[i]}catch(e){this[i]=src[i]}return this}},each:{value:function(callback){var obj={object:function(o){for(var i in o)callback(i,o[i],o)},array:function(o){for(var i=0,len=o.length;i<len;i++)callback(o,i,o[i])}};return obj[typeof this](this)}},hasMethodProperty:{value:function(o){return this.hasOwnProperty(o)&&this.isFunction(o)}},isFunction:{value:function(o){return"function"==typeof this[o]}}}),Object.defineProperties(Array.prototype,{remove:{value:function(){for(var item,x,o=arguments,i=o.length;i&&this.length;)for(item=o[--i];(x=this.indexOf(item))!==-1;)this.splice(x,1);return this}}});