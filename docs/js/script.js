/*!
    eba -- Effortless bible analysis
    Version 0.0.4-2017.05.07
    https://scriptive.github.io/eba
    (c) 2017
*/
!function(e){e.merge({config:{name:"Effortless bible analysis alpha",description:"This is not the entire bible. This is the bible analysis according to topics. Thus it helps to search, check and study the scriptures. Please be advised, read the bible book to meditate.",author:"tuang",version:"0.0.4",build:"1.0.0",id:"eba",idUnique:"eba:unique",developer:"Khen Solomon Lethil",file:{template:"z.html",lang:"https://storage.googleapis.com/effortless/language.json",urlLocal:"eba/bId.xml",urlAPI:["https://storage.googleapis.com/effortless/bId.xml"]},fileStorage:{RequestQuota:1073741824,Permission:1,objectStore:{name:"eba",version:1}},lang:{isLocalRemove:'Would you like to remove "{is}" from local?',tryAWord:"Try a word or two!",noMatchFor:"No match for {for}!",noCategoryContent:"This category has no content...",noCategoryData:"This category has no data...",noBookmark:"No Star...",isNotFound:'Not found: "{is}"',Loading:"Loading",isError:"Error",addLanguage:"Add",removeLanguage:"Remove",manageLanguage:"Add Languages"},classname:{active:"active",inactive:"inactive",filter:"filter"},page:{home:{id:1,name:"Languages",class:"home",title:"Effortless"},category:{id:2,class:"book"},reader:{id:3,class:"chapter"},lookup:{id:4,name:"Search",class:"lookup",title:"Search"},lookupresult:{id:5,title:"Effortless"},bookmark:{id:6,name:"Stars",class:"bookmark",title:"Stars"},randomverse:{id:7,name:"Random Verse",class:"randomverse",title:"Random Verse"},setting:{id:8,name:"Display",class:"setting",title:"Display"},about:{id:9,name:"About",class:"info",title:"About"},contact:{id:10,name:"Contact",class:"info",title:"Contact"}}},initiate:function(){var n=e.config,t=e.localStorage;n.pageHome=Object.keys(n.page)[0];var a=function(){var a=t.select("language").name.language;return new Promise(function(t,o){e.fileStorage=fileStorage(n.fileStorage,{success:function(){e.book.all=a,t()},fail:function(e){o(e)}})}).then(function(){return!0},function(e){return e})},o=function(){var e=t.name.query,a=Object.keys(t.name.language),o={page:n.pageHome,language:a[0],testament:1,category:1,q:"",pagePrevious:n.pageHome,result:""},r={page:function(e,t,a,o){o[e]=n.page.hasOwnProperty(t.toLowerCase())?t.toLowerCase():a},pagePrevious:function(e,t,a,o){o[e]&&n.page.hasOwnProperty(o[e])?a!=o.page&&(o[e]=n.page[a].id<=n.page[o.page].id?a:n.pageHome):o[e]=a,n[e]=o[e]},language:function(e,o,r,i){a.length?a.has(o)||(n[e]=i[r]):t.name.query.page=n.pageHome},q:function(e,n,t,a){a[e]=decodeURIComponent(n)}};return new Promise(function(t,a){try{e.isEmpty()?e.merge(o,n.hash):(o.pagePrevious=e.page,e.merge(n.hash)),e.each(function(e,n,t){r.isFunction(e)&&r[e](e,n,o[e],t)}),t()}catch(e){a(e)}}).then(function(){return t.update("query"),!0},function(e){return e})},r=function(){return e.fileStorage.download({url:n.file.template.replace(/z/,["default","desktop"].join(".")),before:function(e){e.overrideMimeType("text/html; charset=utf-8"),e.responseType="document"}}).then(function(e){try{for(var n=e.data.body;n.firstChild;)document.body.appendChild(n.firstChild);return i().then(function(e){return!0===e&&document.querySelector("div#screen").remove(),e})}catch(e){return e}},function(e){return e})},i=function(){return o().then(function(n){return!0===n?new Promise(function(n,a){e.page[t.name.query.page](n,a)}).then(function(){return document.body.addAttr("id",t.name.query.page),e.Toggle.header().then(function(n){try{e.dataContent()}catch(n){return n}return!0})},function(e){return e}):n})};new Promise(function(o,i){t.select("setting").select("query").select("language").select("randomverse").select("todo"),t.select("bookmark").select("suggestion"),t.name.setting.hasOwnProperty("build")?t.name.setting.build==n.build?n.requireUpdate=0:n.requireUpdate=2:n.requireUpdate=1,n.requireUpdate&&(t.name.setting.version=n.version,t.name.setting.build=n.build,t.update("setting")),a().then(function(n){return document.body.classList.add(e.config.Screen),t.name.setting.hasOwnProperty("class")?t.name.setting.class.each(function(e,n){document.body.classList.add(n)}):t.name.setting.class={},!0===n?r():n}).then(function(e){!0===e?o():i(e)})}).then(function(){e.hashChange(function(){i().then(function(e){!0!==e&&console.log("page error",e)})})},function(n){"object"==typeof n&&n.hasOwnProperty("message")?e.notification(n.message):"string"==typeof n&&e.notification(n)})},dialog:{container:function(){return e.elementSelect("div#dialog")}},nav:{container:function(){return e.elementSelect("nav")},toHome:function(n){window.location.hash=e.config.pageHome},toPrevious:function(n){window.location.hash=n.dataset.hasOwnProperty("page")?n.dataset.page:e.config.pagePrevious},setNamePrevious:function(n){n.innerHTML=e.localStorage.name.query.page,n.eventClick(function(){window.location.hash=n.dataset.hasOwnProperty("page")?n.dataset.page:e.config.pagePrevious})},setTitle:function(n){n.innerHTML=e.config.name},setName:function(n){e.config.page[e.localStorage.name.query.page].hasOwnProperty("title")?n.innerHTML=e.config.page[e.localStorage.name.query.page].title:n.innerHTML=e.config.name},toPage:function(n){e.Toggle.nav(n,function(n,t){n.querySelector("#home").removeClass("active").querySelector("p a").eventClick(function(a){document.body.removeClick(t),n.styleDisplay("none"),e.book.menuName().dataContentEvent(),a.preventDefault(),a.stopPropagation()})}).style.display="none"},setReader:function(n){e.Toggle.menu(n,function(n){var t=n.appendChild(e.elementCreate("ol"));e.config.catalog.each(function(n,a){a.each(function(n,a){t.appendChild(e.elementCreate("li").addAttr("data-cls",a.class).addAttr("data-title",a.total).eventClick(function(n){n.target.toggleClass("active"),e.Toggle.main().querySelectorAll("ol li ol li").each(function(e,n){n.hasClass(a.class)&&n.toggleDisplay()})}).addContent(a.name).addClass("active"))})})},function(){})}},header:{container:function(){return e.elementSelect("header")},lookup:function(e){}},main:{container:function(){return e.elementSelect("main")}},footer:{container:function(){return e.elementSelect("footer")}},page:{home:function(n,t){var a=(e.config,e.localStorage,e.elementCreate("ol"));e.Toggle.main(!0).appendChild(a).setAttribute("class","main-home common-box-main"),e.book.isAvailable()&&e.book.listName(),e.book.isAvailable()||e.book.menuName().dataContentEvent(),n()},category:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol"),i=e.Toggle.main(!0),l=o.name.query,s=l.page,c=l.language;e.config.page[s].title=e.book.all[c].name,i.appendChild(r).setAttribute("class","main-category"),new e.Content(c).xml().then(function(e){e.section(r).then(function(e){},function(e){console.log(e)})},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",o.name.query.language)}).then(function(){n();var t=e.elementCreate("ol");i.appendChild(t).eventClick(function(n){var t=n.target,a=t.getAttribute("class"),o=document.getElementById(a);e.main.container().firstElementChild.scrollTop=o.offsetTop}).setAttribute("class","main-index"),r.querySelectorAll("li.alpha").each(function(n,a){var o=a.innerHTML,r=a.getAttribute("id");t.appendChild(e.elementCreate("li").addAttr("class",r)).innerHTML=o})})},reader:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol"),i=e.Toggle.main(!0),l=o.name.query,s=l.page,c=l.language;e.config.page[s].title=e.book.all[c].name,i.appendChild(r).setAttribute("class","main-reader"),new e.Content(c).xml().then(function(n){n.reader(r,l.category).then(function(e){},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n})},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",c)}).then(function(){n()});var d=i.appendChild(e.elementCreate("ol").addAttr("class","main-footer")),u=d.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("ul"));u.appendChild(e.elementCreate("li")).addClass(a.classname.active).eventClick(function(e){var n=e.target;r.querySelectorAll("ol li ol li.OT").each(function(e,n){n.toggleDisplay()}),n.hasClass(a.classname.active)?n.removeClass(a.classname.active).addClass(a.classname.inactive):n.removeClass(a.classname.inactive).addClass(a.classname.active)}).innerHTML="OT",u.appendChild(e.elementCreate("li")).addClass(a.classname.active).eventClick(function(e){var n=e.target;r.querySelectorAll("ol li ol li.NT").each(function(e,n){n.toggleDisplay()}),n.hasClass(a.classname.active)?n.removeClass(a.classname.active).addClass(a.classname.inactive):n.removeClass(a.classname.inactive).addClass(a.classname.active)}).innerHTML="NT"},randomverse:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol");e.Toggle.main(!0).appendChild(r).setAttribute("class","main-reader");var i=!1,l=(new Date).toLocaleDateString().toString().replace(/\//g,"");new Promise(function(n,t){o.name.randomverse&&o.name.randomverse.isObject()&&!o.name.randomverse.isEmpty()?o.name.randomverse.id!=l&&(o.name.randomverse.id=l,i=!0):(i=!0,o.name.randomverse.id=l),i?new e.Content(o.name.query.language).xml().then(function(e){e.randomverse().then(function(e){o.name.randomverse.verse=e.information,o.update("randomverse"),n()})}):n()}).then(function(){new e.Content(o.name.query.language).xml().then(function(n){n.bookmark(r,o.name.randomverse.verse).then(function(e){},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n})},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",o.name.query.language)}).then(function(){n()})})},lookup:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol");e.Toggle.main(!0).appendChild(r).setAttribute("class","main-lookup common-box-main"),r.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).appendChild(e.elementCreate("input")).addAttr("type","search").addAttr("name","q").addAttr("id","q").addAttr("placeholder","search..."),r.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).eventClick(function(n){var t=n.target;if(t.nextElementSibling)t.nextElementSibling.removeElement();else{var r=t.parentNode.appendChild(e.elementCreate("ol")).eventClick(function(e){var n=e.target,t=n.getAttribute("id");t&&o.name.query.language!=t&&(n.parentNode.querySelector("."+a.classname.active).removeClass(a.classname.active),n.addClass(a.classname.active),o.name.query.language=t)});o.name.language.each(function(n,t){r.appendChild(e.elementCreate("li").addAttr("id",n).addClass(o.name.query.language==n?a.classname.active:a.classname.inactive)).innerHTML=t.name})}}).innerHTML="Language";var i=r.appendChild(e.elementCreate("li").addAttr("class","lsi")).appendChild(e.elementCreate("div")).eventClick(function(e){var n=e.target,t=n.getAttribute("id");if(t&&o.name.query.testament!=t){var r=n.parentNode.querySelector("."+a.classname.active);r&&r.removeClass(a.classname.active),n.addClass(a.classname.active),o.name.query.testament=t}});i.appendChild(e.elementCreate("p").addAttr("id","1").addClass(1==o.name.query.testament?a.classname.active:a.classname.inactive)).innerHTML="OT",i.appendChild(e.elementCreate("p").addAttr("id","2").addClass(2==o.name.query.testament?a.classname.active:a.classname.inactive)).innerHTML="NT",r.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).eventClick(function(){var e=document.getElementById("q").value;e&&o.name.query.language&&o.name.query.testament&&(window.location.hash={q:e,i:(new Date).getTime()}.paramater(["#lookupresult"]))}).innerHTML="Enter",n()},lookupresult:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol"),i=(e.Toggle.main(!0),o.name.query),l=i.page,s=i.language;e.config.page[l].title=o.name.query.q,e.Toggle.main(!0).appendChild(r).setAttribute("class","main-reader"),new e.Content(s).xml().then(function(n){o.name.query.q?n.lookup(r,o.name.query.q).then(function(e){},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n.replace("{for}",o.name.query.q)}):r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.tryAWord},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",o.name.query.book)}).then(function(){n()})},bookmark:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol");e.Toggle.main(!0).appendChild(r).setAttribute("class","main-reader"),new e.Content(o.name.query.language).xml().then(function(n){n.bookmark(r,o.name.bookmark).then(function(e){console.log(e)},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=n})},function(n){r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.isNotFound.replace("{is}",o.name.query.language)}).then(function(){n()})},setting:function(n,t){var a=e.config,o=e.localStorage,r=o.name.setting,i=e.elementCreate("ol"),l={fontsize:{title:"Words size",style:"body {font-size:$100%;}",option:{"80%":{title:"1",class:"size-small-extra"},"90%":{title:"2",class:"size-small"},"100%":{title:"3",class:"size-normal",defaults:!0},"120%":{title:"4",class:"size-large"},"150%":{title:"5",class:"size-large-extra"}}},background:{title:"background colour",style:"body {background-color:$white;}",option:{"#ffffff":{class:"color-white"},"#F8F8F8":{class:"color-lightgray",defaults:!0},"#7f7f7f":{class:"color-dimgrey"},"#b97a59":{class:"color-chocolate"},"#880016":{class:"color-darkred"},"#ed1b24":{class:"color-red"},"#fef102":{class:"color-gold"},"#24b04d":{class:"color-green"},"#3f47cc":{class:"color-darkblue"}}}};e.Toggle.main(!0).appendChild(i).setAttribute("class","main-display"),r.hasOwnProperty("class")||(r.class={}),l.each(function(n,t){var l=i.appendChild(e.elementCreate("li"));l.appendChild(e.elementCreate("h3")).innerHTML=t.title;var s=l.appendChild(e.elementCreate("ol")).addClass(n);t.option.each(function(t,i){var l=s.appendChild(e.elementCreate("li")).addClass(i.class).addClass("icon-ok");if(i.hasOwnProperty("title")&&l.addAttr("data-title",i.title),r.class.hasOwnProperty(n))var c=r.class[n]==i.class?a.classname.active:a.classname.inactive;else if(i.hasOwnProperty("defaults"))var c=a.classname.active;else var c=a.classname.inactive;l.addClass(c).eventClick(function(e){var t=e.target;t.hasClass(a.classname.active)||(t.parentNode.getElementsByClassName(a.classname.active).each(function(e,n){n.removeClass(a.classname.active)}),t.addClass(a.classname.active),r.class.hasOwnProperty(n)&&document.body.hasClass(r.class[n])&&document.body.removeClass(r.class[n]),document.body.hasClass(i.class)||document.body.addClass(i.class),r.class[n]=i.class,o.update("setting"))})})}),n()},about:function(n,t){var a=e.config,o=e.localStorage,r=e.elementCreate("ol");e.Toggle.main(!0).appendChild(r).setAttribute("class","main-information"),r.appendChild(e.elementCreate("li")).innerHTML=a.description,o.name.language.each(function(n,t){var a=r.appendChild(e.elementCreate("li")).addClass(n);a.appendChild(e.elementCreate("h3")).innerHTML=t.name,t.hasOwnProperty("information")&&!t.information.isEmpty()&&(a.appendChild(e.elementCreate("p")).addAttr("data-title","Version").innerHTML=t.information.version,a.appendChild(e.elementCreate("p")).addAttr("data-title","Launched").innerHTML=t.information.launched)}),n()},contact:function(n,t){var a=(e.config,e.localStorage,e.elementCreate("ol"));e.Toggle.main(!0).appendChild(a).setAttribute("class","main-information");var o={email:"supereffortless@gmail.com",introduction:"Please give proper title/subject for your email.",list:["Advice","Broken Report","Copyrights","Discussion","Donation","Mistaken Verse","Question"],conclusion:"You will be replied as soon as possible."};a.appendChild(e.elementCreate("li")).innerHTML=o.email,a.appendChild(e.elementCreate("li")).innerHTML=o.introduction;var r=a.appendChild(e.elementCreate("li"));o.list.each(function(n,t){r.appendChild(e.elementCreate("p")).addAttr("data-title",t).innerHTML="xxxxxxx"}),a.appendChild(e.elementCreate("li")).innerHTML=o.conclusion,n()}},export:{category:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.language).xml().then(function(e){e.exportCategory(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.language)})},testament:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.book).xml().then(function(e){e.exportTestament(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.book)})},book:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.book).xml().then(function(e){e.exportBook(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.book)})},verse:function(n){var t=e.config,a=e.localStorage;return new e.Content(a.name.query.book).xml().then(function(e){e.exportVerse(n).then(function(e){return e},function(e){return e})},function(e){return t.lang.isNotFound.replace("{is}",a.name.query.book)})}},xml:function(n){var t=e.config,a=e.book,o="language",r=e.localStorage.name,i=this;this.open=function(){return e.fileStorage.open({urlLocal:t.file.urlLocal.replace(/bId/,n),readAs:"readAsText"})},this.download=function(o){var r={dir:JSON.parse(JSON.stringify(t.file.urlAPI)),request:function(a){return e.fileStorage.download({url:a,urlLocal:t.file.urlLocal.replace(/bId/,n),before:function(e){e.overrideMimeType("text/xml; charset=utf-8")},progress:o})},process:function(e,t){var o=r.dir.shift().replace(/bId/,n);return r.request(o).then(function(t){t.xml||(t.xml=(new DOMParser).parseFromString(t.data,t.fileType)),a.file[n]=t.xml,e(t)},function(n){r.dir.length?r.process(e,t):t(n)})}};return new Promise(r.process)},this.save=function(t){return new Promise(function(i,l){e.fileStorage.save(t).then(function(t){a.hasOwnProperty(o)&&a[o].hasOwnProperty(n)&&(r[o][n]=a[o][n]),new e.Content(n).xml().then(function(e){e.information().then(function(e){a.hasOwnProperty(o)&&a[o].hasOwnProperty(n)?r[o][n].information=e.information:r[o][n]={name:e.information.name,updated:"0",information:e.information}},function(e){})},function(e){}).then(function(){e.localStorage.update(o),i(t)})},function(e){l(e)})})},this.delete=function(){return new Promise(function(a,i){e.fileStorage.delete({urlLocal:t.file.urlLocal.replace(/bId/,n),fileNotFound:!0}).then(function(t){delete r[o][n],e.localStorage.update(o),a(t)},function(e){i(e)})})},this.request=function(e){return new Promise(function(t,l){a.file.hasOwnProperty(n)?t(a.file[n]):r[o].hasOwnProperty(n)?i.open().then(function(e){e.xml=(new DOMParser).parseFromString(e.fileContent,e.fileType),a.file[n]=e.xml,t(e.xml)},function(e){i.delete().then(function(){l(e)})}):i.download(e).then(function(e){i.save(e).then(function(){console.log("save success")},function(){console.log("save fail")}).then(function(){t(e.xml)})},function(e){l(e)})})}},Content:function(n){var t,a=e.config,o=e.localStorage,r={category:0,section:0,verse:0};a.catalog={};var i=function(n,t,o){return new Promise(function(i,l){var s=c(o);if(!s.length)return l(a.lang.noCategoryData);s.each(function(i,l){var s,c=o||l.getAttribute("id");l.querySelectorAll(p()).each(function(o,i){var l=t(i);if(l){s||(s=g.createOl(n,c)),r.verse++;var d=i.getAttribute("book"),p=d<=39?1:2,f=i.getAttribute("chapter"),h=i.getAttribute("verse"),C=(i.getAttribute("tag"),m(p)),v=(C.innerHTML,u(d).innerHTML),y=e.book.hasBookmark(c,d,f,h)?a.classname.active:a.classname.inactive,b=d<=39?"OT":"NT",k=v.replace(/\s+/g,"-").toLowerCase(),w=s.appendChild(e.elementCreate("li")).addClass(y).addClass(b).addClass(k);containerBookmark=w.appendChild(e.elementCreate("div")).addClass("icon-star").eventClick(function(n){e.book.addBookmark(n.target.parentNode,c,d,f,h)}),containerVerse=w.appendChild(e.elementCreate("div")),containerVerse.addAttr("data-title","123 234:345".replace(123,v).replace(234,f).replace(345,h)),containerVerse.innerHTML=g.replaceNumber(l)}})}),r.verse?i(r):l(o?a.lang.noCategoryContent:a.lang.noMatchFor)})},l=function(e){return e?t.querySelector('info row[id="0"]'.replace(0,e)):t.querySelectorAll("info row")},s=function(e){return e?t.querySelector('section row[id="0"]'.replace(0,e)):t.querySelectorAll("section row")},c=function(e){return t.querySelectorAll(e?'category[id="0"]'.replace(0,e):"category")},d=function(e){return t.querySelectorAll('category[id="0"] row'.replace(0,e))},u=function(e){return e?t.querySelector('book row[id="0"]'.replace(0,e)):t.querySelectorAll("book row")},m=function(e){return e?t.querySelector('testament row[id="0"]'.replace(0,e)):t.querySelectorAll("testament row")},p=function(e,n,t,a,o){var r="row";return e&&(r+='[book="0"]'.replace(0,e)),n&&(r+='[chapter="0"]'.replace(0,n)),t&&(r+='[verse="0"]'.replace(0,t)),a&&(r+='[testament="0"]'.replace(0,a)),o&&(r+='[tag="0"]'.replace(0,o)),r},g={replaceKeyword:function(e,n){return"string"==typeof n?e.replace(new RegExp(n,"gi"),"<b>$&</b>"):e},replaceNumber:function(e){return e.match(/\[(.*?)\]/g).length>1?e.replace(/\[(.*?)\]/g,"<sup>$1</sup>"):e.replace(/\[(.*?)\]/g,"")},createOl:function(n,t){r.category++;var a=s(t),o=n.appendChild(e.elementCreate("li"));o.appendChild(e.elementCreate("h2")).addAttr("data-description",a.innerHTML).innerHTML=a.getAttribute("name");return o.appendChild(e.elementCreate("ol"))}},f={section:function(n){return new Promise(function(t,a){var o=[];s().each(function(t,a){r.section++;var i=a.getAttribute("id"),l=a.getAttribute("name"),s=(a.getAttribute("sort"),a.innerHTML,l.charAt(0));o.has(s)||(o.push(s),n.appendChild(e.elementCreate("li").addClass("alpha").addAttr("id",s)).innerHTML=s),n.appendChild(e.elementCreate("li")).addClass("icon-arrow-right").addAttr("data-title",i).appendChild(e.elementCreate("a")).addAttr("data-total",d(i).length).addAttr("data-description",a.innerHTML).addAttr("href",{category:i}.paramater(["#reader"])).innerHTML=l}),t(r)})},randomverse:function(){return new Promise(function(e,n){r.information={};var t=Math.floor(Math.random()*s().length),a=d(t),o=Math.floor(Math.random()*a.length),i=a[o],l=i.getAttribute("book"),c=i.getAttribute("chapter"),u=i.getAttribute("verse");r.information[t]={},r.information[t][l]={},r.information[t][l][c]=[u],e(r)})},information:function(){return new Promise(function(e,n){r.information={},l().each(function(e,n){r.section++;var t=n.getAttribute("id");r.information[t]=n.innerHTML}),e(r)})},reader:function(e,n){return i(e,function(e){return e.innerHTML},n)},lookup:function(e,n){return i(e,function(e){var t=e.getAttribute("testament");if(new RegExp(n,"i").test(e.innerHTML)){var t=e.getAttribute("testament");if(!t)return g.replaceKeyword(e.innerHTML,n);if(t==o.name.testament)return g.replaceKeyword(e.innerHTML,n)}})},bookmark:function(n,t){return new Promise(function(i,l){t.each(function(t,i){var l;i.each(function(i,s){s.each(function(s,d){d.each(function(d,f){c(t).each(function(c,d){d.querySelectorAll(p(i,s,f)).each(function(c,d){l||(l=g.createOl(n,t)),r.verse++;var p=i<=39?1:2,h=m(p).innerHTML,C=u(i).innerHTML,v=h.replace(" ","-").toLowerCase(),y=C.replace(" ","-").toLowerCase(),b=e.book.hasBookmark(t,i,s,f)?a.classname.active:a.classname.inactive,k=l.appendChild(e.elementCreate("li")).addClass(b).addClass(v).addClass(y),w=(k.appendChild(e.elementCreate("div")).addClass("icon-star").eventClick(function(n){var r=n.target.parentNode;e.book.addBookmark(r,t,i,s,f),"randomverse"!=o.name.query.page&&(r=r.removeElement(),""===r.innerHTML&&(r=r.parentNode.removeElement(),""===r.innerHTML&&(r.addAttr("class","msg").appendChild(e.elementCreate("li")).appendChild(e.elementCreate("div")).innerHTML=a.lang.noBookmark)))}),k.appendChild(e.elementCreate("div")));w.addAttr("data-title","123 234:345".replace(123,C).replace(234,s).replace(345,f)),w.innerHTML=g.replaceNumber(d.innerHTML)})})})})})}),r.verse?i(r):l(a.lang.noBookmark)})}};this.xml=function(){return new Promise(function(a,o){new e.xml(n).request(function(){}).then(function(e){t=e,a(f)},function(e){o(e)})})}},book:{file:{},addBookmark:function(n,t,a,o,r){var i=e.localStorage,l=i.name.bookmark;n.hasClass(e.config.classname.active)?(l[t][a][o].splice(l[t][a][o].indexOf(r),1),l[t][a][o].length<=0&&(delete l[t][a][o],l[t][a].isEmpty()&&(delete l[t][a],l[t].isEmpty()&&delete l[t])),n.removeClass(e.config.classname.active)):(l.hasOwnProperty(t)||(l[t]={}),l[t].hasOwnProperty(a)||(l[t][a]={}),l[t][a].hasOwnProperty(o)||(l[t][a][o]=[]),l[t][a][o].push(r.toString()),n.addClass(e.config.classname.active)),i.update("bookmark")},hasBookmark:function(n,t,a,o){var r=e.localStorage.name.bookmark;if(r.hasOwnProperty(n)&&r[n].hasOwnProperty(t)&&r[n][t].hasOwnProperty(a))return r[n][t][a].has(o)},isAvailable:function(n){var t=e.localStorage;return!(!t.name.hasOwnProperty("language")||!t.name.language.isObject()||t.name.language.isEmpty())&&(!n||t.name.language.hasOwnProperty(n))},listName:function(){var n=e.elementCreate("ol");e.Toggle.main(!0).appendChild(n).setAttribute("class","main-home common-box-main"),e.localStorage.name.language.each(function(t,a){n.appendChild(e.elementCreate("li")).appendChild(e.elementCreate("a")).addAttr("href",{language:t}.paramater(["#category"])).innerHTML=a.name})},menuName:function(){var n=e.config,t=e.localStorage,a=e.nav.container(),o=a.firstElementChild,r=o.firstElementChild,i=r.nextElementSibling,l=JSON.parse(JSON.stringify(t.name.query)).page,s={dataContentOpen:function(){t.name.query.page=n.pageHome,e.fileStorage.download({url:n.file.lang}).then(function(o){a.style.display="block",t.update("query"),i.emptyElement(),e.book.language=JSON.parse(o.data);var r=i.appendChild(e.elementCreate("ul"));e.book.language.each(function(t,a){var o=e.elementCreate("li"),i=e.elementCreate("div"),l=e.elementCreate("div");i.innerHTML=a.name,l.eventClick(function(a){e.book.isAvailable(t)?new e.xml(t).delete().then(function(){l.innerHTML=n.lang.addLanguage},function(){}):new e.xml(t).download(function(){l.emptyElement().appendChild(e.elementCreate("span").addAttr("class","icon-loading animate-spin"))}).then(function(a){return new e.xml(t).save(a).then(function(){l.innerHTML=n.lang.removeLanguage},function(e){l.innerHTML=n.lang.addLanguage})},function(){l.innerHTML=n.lang.isError})}).innerHTML=n.lang.addLanguage,e.book.isAvailable(t)&&(o.setAttribute("class",n.classname.active),l.innerHTML=n.lang.removeLanguage),o.appendChild(i),o.appendChild(l),r.appendChild(o)})},function(e){console.log(e)})},dataContentTarget:function(n){!o.contains(n.target)&&e.book.isAvailable()&&s.dataContentClose(),n.stopPropagation()},dataContentClose:function(){i.emptyElement(),document.body.classList.contains("nav")||document.body.removeClick(s.dataContentTarget),a.styleDisplay("none"),n.page[t.name.query.page].hasOwnProperty("name")&&(window.location.hash={i:(new Date).getTime()}.paramater(["#"+l]))},dataContentEvent:function(e){a.toggleDisplay(function(){s.dataContentOpen(),document.body.classList.contains("nav")||document.body.eventClick(s.dataContentTarget)},function(){s.dataContentClose()})}};return s}},languageMenu:function(e){}})}(scriptive("app"));